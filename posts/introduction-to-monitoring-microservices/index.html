<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>An Introduction to Monitoring Microservices with Prometheus and Grafana | Navendu Pottekkat</title><meta name=keywords content="monitoring,prometheus,tutorials"><meta name=description content="This tutorial walks you through setting up monitoring on a microservice application using Prometheus and Grafana."><meta name=author content="Navendu Pottekkat"><link rel=canonical href=https://navendu.me/posts/introduction-to-monitoring-microservices/><script defer data-domain=navendu.me src=/misc/js/script.js data-api=/misc/api/event></script><script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script><script></script><link crossorigin=anonymous href=/assets/css/stylesheet.66e3e513d75c2ff303648a5691fa6787b3c8f1dc4b3307618713a4dc494f0696.css integrity="sha256-ZuPlE9dcL/MDZIpWkfpnh7PI8dxLMwdhhxOk3ElPBpY=" rel="preload stylesheet" as=style><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=https://navendu.me/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://navendu.me/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://navendu.me/favicon-32x32.png><link rel=apple-touch-icon href=https://navendu.me/apple-touch-icon.png><link rel=mask-icon href=https://navendu.me/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:title" content="An Introduction to Monitoring Microservices with Prometheus and Grafana"><meta property="og:description" content="This tutorial walks you through setting up monitoring on a microservice application using Prometheus and Grafana."><meta property="og:type" content="article"><meta property="og:url" content="https://navendu.me/posts/introduction-to-monitoring-microservices/"><meta property="og:image" content="https://navendu.me/images/introduction-to-monitoring-microservices/man-in-cave-banner.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-09T10:15:51+05:30"><meta property="article:modified_time" content="2023-09-26T16:25:00+05:30"><meta property="og:site_name" content="Navendu Pottekkat"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://navendu.me/images/introduction-to-monitoring-microservices/man-in-cave-banner.png"><meta name=twitter:title content="An Introduction to Monitoring Microservices with Prometheus and Grafana"><meta name=twitter:description content="This tutorial walks you through setting up monitoring on a microservice application using Prometheus and Grafana."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://navendu.me/posts/"},{"@type":"ListItem","position":2,"name":"An Introduction to Monitoring Microservices with Prometheus and Grafana","item":"https://navendu.me/posts/introduction-to-monitoring-microservices/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"An Introduction to Monitoring Microservices with Prometheus and Grafana","name":"An Introduction to Monitoring Microservices with Prometheus and Grafana","description":"This tutorial walks you through setting up monitoring on a microservice application using Prometheus and Grafana.","keywords":["monitoring","prometheus","tutorials"],"articleBody":"Continuous monitoring is critical in making microservice systems robust. Without proper monitoring, microservices can quickly become overwhelmed, leading to errors and loss in performance.\nThrough continuous monitoring, developers can detect issues with their services as soon as they arise and take measures to prevent significant damage. It also provides insights into how your services are performing, allowing you to make informed decisions.\nThis article will introduce how you can set up monitoring on your microservice application using two of the popular tools in this space, Prometheus, and Grafana.\nThe source code and Docker Compose file for this tutorial are available in monitoring-101.\nPrometheus Basics Prometheus is an open source, monitoring and alerting tool. It “pulls” metrics (measurements) from microservices by sending HTTP requests and stores the results in a time-series database.\nYou can instrument your services by using client libraries provided by Prometheus. This will enable you to create and collect custom metrics from your services.\nPrometheus also has exporters that let you pull metrics that are not in Prometheus format. An exporter acts as a middleman and transforms exported data into Prometheus readable format.\n Prometheus   Prometheus provides a powerful query language, PromQL, to work with this collected data. You can use PromQL to create complex queries to filter, aggregate, and transform the data to the desired format.\nIn addition to pulling metrics, Prometheus can also trigger alerts when set thresholds are breached. The alerting mechanism is highly configurable and can send notifications to places like Slack or email.\nPrometheus has a GUI that lets you visualize the collected metrics easily. It also integrates with other advanced visualization tools like Grafana.\n Prometheus DashboardShows the memory stats of a Go-based service\n  Metric Types Prometheus offers four core metric types:\n Counter: represents a single monotonically increasing counter. Its value can increase or reset to zero on restart. You can use it to represent metrics like the number of requests served. Gauge: represents a numerical value that can go up or down. You can use it to represent values like memory usage or the number of requests per second. Histogram: samples data into configurable buckets. Use it to represent values like request durations or response sizes. Summary: similar to histogram, it also calculates configurable values over a sliding time window.  You can learn more about these metric types and how to use them from the official documentation.\nSample Application Our sample application will consist of an API gateway, a Go app, and a Python app:\n Sample applicationThe application will return, “Hello name!” in the language you choose with the  you provide. Apache APISIX will be the API gateway that directs traffic to your services.\n  The diagram below shows how the system works:\n Sample application sequence    The user sends a GET request to APISIX, the entry point for the application. APISIX forwards the request to the Go service. The Go service sends a GET request to the Python service to obtain “Hello” in the specified language. The Python service responds with the required translation of “Hello.” The Go service creates the required response by using the name provided in the query and sends it to APISIX. APISIX forwards the response back to the user.  Configuring Prometheus to Collect Metrics We will instrument and export metrics from all the services in our application and collect them in Prometheus. We will start with our API gateway, Apache APISIX.\nExporting Metrics from APISIX Apache APISIX is an open source, cloud native API gateway.\nYou don’t need to know about APISIX to follow along, and you can use the Docker Compose file provided to set everything up. To learn more about APISIX, visit apisix.apache.org.\nAPISIX offers a prometheus Plugin that easily exports metrics in the Prometheus format. You can configure the Plugin in your APISIX configuration file:\napisix: enable_admin: false # run APISIX in standalone mode config_center: yaml # use a YAML file for configuration instead of storing it in etcd plugin_attr: prometheus: export_uri: /prometheus/metrics # enable the prometheus Plugin and export the metrics to this URI enable_export_server: false # export the metrics in the default data-plane port  We can now enable the Plugin on every Route by making it a Global rule:\nroutes: # route requests to /hello/* to the go-app - uri: /hello/* upstream: type: roundrobin nodes: \"go-app:8080\": 1 plugins: # remove the prefix \"/hello\" before forwarding the request to the go-app  proxy-rewrite: regex_uri: - \"/hello/(.*)\" - \"/$1\" # export Prometheus metrics to the specified URI - uri: /prometheus/metrics plugins: public-api: # enable the Prometheus Plugin globally on all Routes global_rules: - id: 1 plugins: prometheus: prefer_name: true #END This will export the metrics to the /prometheus/metrics endpoint in Apache APISIX.\nYou can learn more about the available metrics from the documentation.\nInstrumenting and Exporting Metrics from the Go Service Prometheus has an official Go client library for instrumenting Go applications.\nBy default, Prometheus will expose the default Go metrics. You can also create your own application-specific metrics.\nIn our service, we will expose the default metrics and create our own counter metric to track the number of requests:\npackage main import ( \"encoding/json\" \"fmt\" \"io/ioutil\" \"log\" \"net/http\" \"os\" // Prometheus packages \t\"github.com/prometheus/client_golang/prometheus\" \"github.com/prometheus/client_golang/prometheus/promauto\" \"github.com/prometheus/client_golang/prometheus/promhttp\" ) // Response stores the Message obtained from the python-app type Response struct { Message string `json:\"message\"` } // default language and name var ( lang = \"en\" name = \"John\" ) // create a new custom Prometheus counter metric var pingCounter = promauto.NewCounter( prometheus.CounterOpts{ Name: \"go_app_request_count\", Help: \"No of requests handled by the go-app\", }, ) // HelloHandler handles requests to the go-app func HelloHandler(w http.ResponseWriter, r *http.Request) { lang = r.URL.String() name = r.URL.Query()[\"name\"][0] fmt.Println(\"Request for\", lang, \"with name\", name) pingCounter.Inc() pUrl := os.Getenv(\"PYTHON_APP_URL\") if len(pUrl) == 0 { pUrl = \"localhost\" } // call the python-app to obtain the translation \tresp, err := http.Get(\"http://\" + pUrl + \":8000\" + lang) if err != nil { log.Fatalln(err) } body, err := ioutil.ReadAll(resp.Body) if err != nil { log.Fatalln(err) } resp.Body.Close() var m Response json.Unmarshal(body, \u0026m) // send back response with \"Hello name!\" in the specified language \tfmt.Fprintf(w, \"%s %s!\", m.Message, name) } func main() { // expose Prometheus metrics \thttp.Handle(\"/metrics\", promhttp.Handler()) http.HandleFunc(\"/\", HelloHandler) http.ListenAndServe(\":8080\", nil) } This will expose the metrics to the endpoint /metrics. You can learn more about the Go client library from its GitHub repo.\nInstrumenting and Exporting Metrics from the Python Service Prometheus also has an official Python client library. There are also third-party libraries that are tailored to fit specific use cases.\nOur service uses FastAPI, and we will use the prometheus_fastapi_instrumentator library to instrument it:\nfrom fastapi import FastAPI from fastapi.middleware.cors import CORSMiddleware from prometheus_fastapi_instrumentator import Instrumentator app = FastAPI() hello = {\"en\": \"Hello\", \"fr\": \"Bonjour\", \"es\": \"Hola\", \"ml\": \"ഹലോ\"} # expose the default Python metrics to the /metrics endpoint Instrumentator().instrument(app).expose(app) @app.get(\"/{lang}\") async def get_hello(lang): return {\"message\": hello[lang]} You can learn more about creating custom metrics from the documentation.\nConfiguring Prometheus We can now scrape and collect these metrics in Prometheus.\nYou can configure Prometheus to collect metrics from each of the services. By default, Prometheus checks for metrics in the /metrics path:\nglobal: scrape_interval: 15s evaluation_interval: 15s scrape_configs: - job_name: \"prometheus\" static_configs: - targets: [\"localhost:9090\"] - job_name: \"go-app\" static_configs: - targets: [\"go-app:8080\"] - job_name: \"python-app\" static_configs: - targets: [\"python-app:8000\"] - job_name: \"apisix\" static_configs: - targets: [\"apisix:9080\"] metrics_path: \"/prometheus/metrics\" That’s it! Now, if you open up the Prometheus dashboard (default on port 9090) and click on “Status” from the navbar and “Targets,” you will be able to see the status of metrics being scraped from your services.\n Prometheus targetsMetrics are successfully being scraped from all sources\n  Querying and Visualizing Metrics in Prometheus Now, you can use the Prometheus dashboard to run queries and complex expressions.\n Querying PrometheusYou can get a lot more complex with your queries than this\n  You can learn more about querying Prometheus in the official documentation.\nUsing Grafana to Query Prometheus Grafana is an open source data visualization platform that works with Prometheus to provide a comprehensive tool for collecting, querying, and visualizing metrics.\nPrometheus is good at collecting metrics and querying but lacks in providing tooling for creating meaningful visualizations. Grafana overcomes this limitation by transforming the collected metrics into visualizations.\nGrafana is also compatible with many other data sources than Prometheus.\nOnce you have deployed Grafana, you can open the web UI (default on port 3000).\nFirst, you have to add Prometheus as a data source. To do this, go to `/datasources or “Configuration” and “Data sources.” Click on “Add data source” and select Prometheus. Specify where Prometheus is deployed, save and test the connection.\n Add Prometheus as a data sourceAdd the details of your Prometheus service, save, and test it\n  Using Pre-built Grafana Dashboards Grafana hosts a public dashboard repository that contains pre-built Grafana dashboards. You can use them in your Grafana instance to quickly visualize relevant metrics.\nWe will use the Go Processes dashboard which will process and visualize the process status published by the Prometheus Go client library.\nTo import this template, first, copy its ID (6671) from the dashboard repository. In your Grafana UI, go to “Dashboards” and select “Import.” Paste the ID you copied and click “Load.”\n Grafana dashboardVisualizes the process status of the Go service\n  You can also explore other pre-built dashboards or create your own. Refer to the documentation to learn more about this.\nWhat’s Next? That’s it for this tutorial!\nThis article was only an introduction to how you can set up monitoring on your services, and I encourage you to learn more about Prometheus and Grafana from the resources mentioned below:\n Prometheus Best Practices Alerting based on metrics Grafana Dashboards  The complete code and the Docker Compose file for this tutorial are available in monitoring-101.\n","wordCount":"1617","inLanguage":"en","image":"https://navendu.me/images/introduction-to-monitoring-microservices/man-in-cave-banner.png","datePublished":"2022-12-09T10:15:51+05:30","dateModified":"2023-09-26T16:25:00+05:30","author":{"@type":"Person","name":"Navendu Pottekkat"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://navendu.me/posts/introduction-to-monitoring-microservices/"},"publisher":{"@type":"Person","name":"Navendu Pottekkat","logo":{"@type":"ImageObject","url":"https://navendu.me/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://navendu.me/ accesskey=h title="Navendu Pottekkat (Alt + H)">Navendu Pottekkat</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://navendu.me/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://navendu.me/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://navendu.me/dailies/ title="Daily Logs"><span>Daily Logs</span></a></li><li><a href=https://navendu.me/about/ title=About><span>About</span></a></li><li><a href=https://navendu.me/subscribe/ title=Subscribe><span>Subscribe</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://navendu.me/>Home</a>&nbsp;»&nbsp;<a href=https://navendu.me/posts/>Posts</a></div><h1 class=post-title>An Introduction to Monitoring Microservices with Prometheus and Grafana</h1><div class=post-meta><span title="2022-12-09 10:15:51 +0530 +0530">December 9, 2022</span>&nbsp;·&nbsp;8 min&nbsp;|&nbsp;<a href=https://github.com/pottekkat/personal-website/blob/hugo/content/posts/introduction-to-monitoring-microservices.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><figure class=entry-cover><img loading=lazy src=https://navendu.me/images/introduction-to-monitoring-microservices/man-in-cave-banner.png alt="A man exploring a cave with a lit torch."><p>Photo by <a href="https://unsplash.com/@bobbystevenson?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Bobby Stevenson</a> on <a href="https://unsplash.com/s/photos/fire-torch?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText">Unsplash</a></p></figure><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on twitter" href="https://twitter.com/intent/tweet/?text=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f&hashtags=monitoring%2cprometheus%2ctutorials"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f&title=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&summary=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&source=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f&title=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on whatsapp" href="https://api.whatsapp.com/send?text=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana%20-%20https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on telegram" href="https://telegram.me/share/url?text=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#prometheus-basics aria-label="Prometheus Basics">Prometheus Basics</a><ul><li><a href=#metric-types aria-label="Metric Types">Metric Types</a></li></ul></li><li><a href=#sample-application aria-label="Sample Application">Sample Application</a></li><li><a href=#configuring-prometheus-to-collect-metrics aria-label="Configuring Prometheus to Collect Metrics">Configuring Prometheus to Collect Metrics</a><ul><li><a href=#exporting-metrics-from-apisix aria-label="Exporting Metrics from APISIX">Exporting Metrics from APISIX</a></li><li><a href=#instrumenting-and-exporting-metrics-from-the-go-service aria-label="Instrumenting and Exporting Metrics from the Go Service">Instrumenting and Exporting Metrics from the Go Service</a></li><li><a href=#instrumenting-and-exporting-metrics-from-the-python-service aria-label="Instrumenting and Exporting Metrics from the Python Service">Instrumenting and Exporting Metrics from the Python Service</a></li><li><a href=#configuring-prometheus aria-label="Configuring Prometheus">Configuring Prometheus</a></li></ul></li><li><a href=#querying-and-visualizing-metrics-in-prometheus aria-label="Querying and Visualizing Metrics in Prometheus">Querying and Visualizing Metrics in Prometheus</a></li><li><a href=#using-grafana-to-query-prometheus aria-label="Using Grafana to Query Prometheus">Using Grafana to Query Prometheus</a><ul><li><a href=#using-pre-built-grafana-dashboards aria-label="Using Pre-built Grafana Dashboards">Using Pre-built Grafana Dashboards</a></li></ul></li><li><a href=#whats-next aria-label="What&amp;rsquo;s Next?">What&rsquo;s Next?</a></li></ul></div></details></div><div class=post-content><p>Continuous monitoring is critical in making microservice systems robust. Without proper monitoring, microservices can quickly become overwhelmed, leading to errors and loss in performance.</p><p>Through continuous monitoring, developers can detect issues with their services as soon as they arise and take measures to prevent significant damage. It also provides insights into how your services are performing, allowing you to make informed decisions.</p><p>This article will introduce how you can set up monitoring on your microservice application using two of the popular tools in this space, <a href="https://prometheus.io/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Prometheus</a>, and <a href="https://grafana.com/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Grafana</a>.</p><p>The source code and Docker Compose file for this tutorial are available in <a href="https://github.com/pottekkat/monitoring-101?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>monitoring-101</a>.</p><h2 id=prometheus-basics>Prometheus Basics<a hidden class=anchor aria-hidden=true href=#prometheus-basics>#</a></h2><p>Prometheus is an open source, monitoring and alerting tool. It &ldquo;pulls&rdquo; metrics (measurements) from microservices by sending HTTP requests and stores the results in a time-series database.</p><p>You can instrument your services by using <a href="https://prometheus.io/docs/instrumenting/clientlibs/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>client libraries</a> provided by Prometheus. This will enable you to create and collect custom metrics from your services.</p><p>Prometheus also has <a href="https://prometheus.io/docs/instrumenting/exporters/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>exporters</a> that let you pull metrics that are not in Prometheus format. An exporter acts as a middleman and transforms exported data into Prometheus readable format.</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/prometheus.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/prometheus.png#center alt=Prometheus></a><figcaption>Prometheus</figcaption></figure><p>Prometheus provides a powerful query language, <a href="https://prometheus.io/docs/prometheus/latest/querying/basics/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>PromQL</a>, to work with this collected data. You can use PromQL to create complex queries to filter, aggregate, and transform the data to the desired format.</p><p>In addition to pulling metrics, Prometheus can also trigger <a href="https://prometheus.io/docs/alerting/latest/overview/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>alerts</a> when set thresholds are breached. The alerting mechanism is highly configurable and can send notifications to places like Slack or email.</p><p>Prometheus has a GUI that lets you visualize the collected metrics easily. It also integrates with other advanced visualization tools like Grafana.</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/prometheus-dashboard.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/prometheus-dashboard.png#center alt="Prometheus Dashboard"></a><figcaption>Prometheus Dashboard<p>Shows the memory stats of a Go-based service</p></figcaption></figure><h3 id=metric-types>Metric Types<a hidden class=anchor aria-hidden=true href=#metric-types>#</a></h3><p>Prometheus offers four core metric types:</p><ol><li><strong>Counter</strong>: represents a single monotonically increasing counter. Its value can increase or reset to zero on restart. You can use it to represent metrics like the number of requests served.</li><li><strong>Gauge</strong>: represents a numerical value that can go up or down. You can use it to represent values like memory usage or the number of requests per second.</li><li><strong>Histogram</strong>: samples data into configurable buckets. Use it to represent values like request durations or response sizes.</li><li><strong>Summary</strong>: similar to histogram, it also calculates configurable values over a sliding time window.</li></ol><p>You can learn more about these metric types and how to use them from the <a href="https://prometheus.io/docs/tutorials/understanding_metric_types/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>official documentation</a>.</p><h2 id=sample-application>Sample Application<a hidden class=anchor aria-hidden=true href=#sample-application>#</a></h2><p>Our <a href="https://github.com/pottekkat/monitoring-101?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>sample application</a> will consist of an API gateway, a Go app, and a Python app:</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/sample-application.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/sample-application.png#center alt="Sample application"></a><figcaption>Sample application<p>The application will return, &ldquo;Hello <code>name</code>!&rdquo; in the language you choose with the <code>&lt;name></code> you provide. Apache APISIX will be the API gateway that directs traffic to your services.</p></figcaption></figure><p>The diagram below shows how the system works:</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/sequence.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/sequence.png#center alt="Sample application sequence"></a><figcaption>Sample application sequence</figcaption></figure><ol><li>The user sends a GET request to APISIX, the entry point for the application.</li><li>APISIX forwards the request to the Go service.</li><li>The Go service sends a GET request to the Python service to obtain &ldquo;Hello&rdquo; in the specified language.</li><li>The Python service responds with the required translation of &ldquo;Hello.&rdquo;</li><li>The Go service creates the required response by using the name provided in the query and sends it to APISIX.</li><li>APISIX forwards the response back to the user.</li></ol><h2 id=configuring-prometheus-to-collect-metrics>Configuring Prometheus to Collect Metrics<a hidden class=anchor aria-hidden=true href=#configuring-prometheus-to-collect-metrics>#</a></h2><p>We will instrument and export metrics from all the services in our application and collect them in Prometheus. We will start with our API gateway, <a href="https://apisix.apache.org/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Apache APISIX</a>.</p><h3 id=exporting-metrics-from-apisix>Exporting Metrics from APISIX<a hidden class=anchor aria-hidden=true href=#exporting-metrics-from-apisix>#</a></h3><p>Apache APISIX is an open source, cloud native API gateway.</p><p>You don&rsquo;t need to know about APISIX to follow along, and you can use the <a href="https://github.com/pottekkat/monitoring-101/blob/master/docker-compose.yml?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Docker Compose file</a> provided to set everything up. To learn more about APISIX, visit <a href="https://apisix.apache.org/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>apisix.apache.org</a>.</p><p>APISIX offers a <a href="https://apisix.apache.org/docs/apisix/2.15/plugins/prometheus/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>prometheus Plugin</a> that easily exports metrics in the Prometheus format. You can configure the Plugin in your APISIX configuration file:</p><div class=highlight title=config.yml><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>apisix</span>:
  <span style=color:#f92672>enable_admin</span>: <span style=color:#66d9ef>false</span> <span style=color:#75715e># run APISIX in standalone mode</span>
  <span style=color:#f92672>config_center</span>: <span style=color:#ae81ff>yaml</span> <span style=color:#75715e># use a YAML file for configuration instead of storing it in etcd</span>
<span style=color:#f92672>plugin_attr</span>:
  <span style=color:#f92672>prometheus</span>:
    <span style=color:#f92672>export_uri</span>: <span style=color:#ae81ff>/prometheus/metrics</span> <span style=color:#75715e># enable the prometheus Plugin and export the metrics to this URI</span>
    <span style=color:#f92672>enable_export_server</span>: <span style=color:#66d9ef>false</span> <span style=color:#75715e># export the metrics in the default data-plane port </span>
</code></pre></div><p>We can now enable the Plugin on every Route by making it a <a href="https://apisix.apache.org/docs/apisix/2.15/terminology/global-rule/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Global rule</a>:</p><div class=highlight title=apisix.yml><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>routes</span>:
  <span style=color:#75715e># route requests to /hello/* to the go-app</span>
  - <span style=color:#f92672>uri</span>: <span style=color:#ae81ff>/hello/*</span>
    <span style=color:#f92672>upstream</span>:
      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>roundrobin</span>
      <span style=color:#f92672>nodes</span>:
        <span style=color:#f92672>&#34;go-app:8080&#34;: </span><span style=color:#ae81ff>1</span>
    <span style=color:#f92672>plugins</span>:
      <span style=color:#75715e># remove the prefix &#34;/hello&#34; before forwarding the request to the go-app </span>
      <span style=color:#f92672>proxy-rewrite</span>:
        <span style=color:#f92672>regex_uri</span>:
          - <span style=color:#e6db74>&#34;/hello/(.*)&#34;</span>
          - <span style=color:#e6db74>&#34;/$1&#34;</span>
  <span style=color:#75715e># export Prometheus metrics to the specified URI</span>
  - <span style=color:#f92672>uri</span>: <span style=color:#ae81ff>/prometheus/metrics</span>
    <span style=color:#f92672>plugins</span>:
      <span style=color:#f92672>public-api</span>:
<span style=color:#75715e># enable the Prometheus Plugin globally on all Routes</span>
<span style=color:#f92672>global_rules</span>:
  - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>1</span>
    <span style=color:#f92672>plugins</span>:
      <span style=color:#f92672>prometheus</span>:
        <span style=color:#f92672>prefer_name</span>: <span style=color:#66d9ef>true</span>
<span style=color:#75715e>#END</span>
</code></pre></div><p>This will export the metrics to the <code>/prometheus/metrics</code> endpoint in Apache APISIX.</p><p>You can learn more about the available metrics from the <a href="https://apisix.apache.org/docs/apisix/2.15/plugins/prometheus/#available-http-metrics?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>documentation</a>.</p><h3 id=instrumenting-and-exporting-metrics-from-the-go-service>Instrumenting and Exporting Metrics from the Go Service<a hidden class=anchor aria-hidden=true href=#instrumenting-and-exporting-metrics-from-the-go-service>#</a></h3><p>Prometheus has an <a href="https://github.com/prometheus/client_golang?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>official Go client library</a> for instrumenting Go applications.</p><p>By default, Prometheus will expose the default Go metrics. You can also create your own application-specific metrics.</p><p>In our service, we will expose the default metrics and create our own counter metric to track the number of requests:</p><div class=highlight title=main.go><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>

<span style=color:#f92672>import</span> (
	<span style=color:#e6db74>&#34;encoding/json&#34;</span>
	<span style=color:#e6db74>&#34;fmt&#34;</span>
	<span style=color:#e6db74>&#34;io/ioutil&#34;</span>
	<span style=color:#e6db74>&#34;log&#34;</span>
	<span style=color:#e6db74>&#34;net/http&#34;</span>
	<span style=color:#e6db74>&#34;os&#34;</span>

	<span style=color:#75715e>// Prometheus packages
</span><span style=color:#75715e></span>	<span style=color:#e6db74>&#34;github.com/prometheus/client_golang/prometheus&#34;</span>
	<span style=color:#e6db74>&#34;github.com/prometheus/client_golang/prometheus/promauto&#34;</span>
	<span style=color:#e6db74>&#34;github.com/prometheus/client_golang/prometheus/promhttp&#34;</span>
)

<span style=color:#75715e>// Response stores the Message obtained from the python-app
</span><span style=color:#75715e></span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Response</span> <span style=color:#66d9ef>struct</span> {
	<span style=color:#a6e22e>Message</span> <span style=color:#66d9ef>string</span> <span style=color:#e6db74>`json:&#34;message&#34;`</span>
}

<span style=color:#75715e>// default language and name
</span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> (
	<span style=color:#a6e22e>lang</span> = <span style=color:#e6db74>&#34;en&#34;</span>
	<span style=color:#a6e22e>name</span> = <span style=color:#e6db74>&#34;John&#34;</span>
)

<span style=color:#75715e>// create a new custom Prometheus counter metric
</span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>pingCounter</span> = <span style=color:#a6e22e>promauto</span>.<span style=color:#a6e22e>NewCounter</span>(
	<span style=color:#a6e22e>prometheus</span>.<span style=color:#a6e22e>CounterOpts</span>{
		<span style=color:#a6e22e>Name</span>: <span style=color:#e6db74>&#34;go_app_request_count&#34;</span>,
		<span style=color:#a6e22e>Help</span>: <span style=color:#e6db74>&#34;No of requests handled by the go-app&#34;</span>,
	},
)

<span style=color:#75715e>// HelloHandler handles requests to the go-app
</span><span style=color:#75715e></span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>HelloHandler</span>(<span style=color:#a6e22e>w</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ResponseWriter</span>, <span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Request</span>) {
	<span style=color:#a6e22e>lang</span> = <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>URL</span>.<span style=color:#a6e22e>String</span>()
	<span style=color:#a6e22e>name</span> = <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>URL</span>.<span style=color:#a6e22e>Query</span>()[<span style=color:#e6db74>&#34;name&#34;</span>][<span style=color:#ae81ff>0</span>]

	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;Request for&#34;</span>, <span style=color:#a6e22e>lang</span>, <span style=color:#e6db74>&#34;with name&#34;</span>, <span style=color:#a6e22e>name</span>)
	<span style=color:#a6e22e>pingCounter</span>.<span style=color:#a6e22e>Inc</span>()

	<span style=color:#a6e22e>pUrl</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;PYTHON_APP_URL&#34;</span>)
	<span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>pUrl</span>) <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> {
		<span style=color:#a6e22e>pUrl</span> = <span style=color:#e6db74>&#34;localhost&#34;</span>
	}

	<span style=color:#75715e>// call the python-app to obtain the translation
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>resp</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#e6db74>&#34;http://&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>pUrl</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;:8000&#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>lang</span>)
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#a6e22e>err</span>)
	}

	<span style=color:#a6e22e>body</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>ioutil</span>.<span style=color:#a6e22e>ReadAll</span>(<span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Body</span>)
	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatalln</span>(<span style=color:#a6e22e>err</span>)
	}

	<span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Body</span>.<span style=color:#a6e22e>Close</span>()

	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>m</span> <span style=color:#a6e22e>Response</span>
	<span style=color:#a6e22e>json</span>.<span style=color:#a6e22e>Unmarshal</span>(<span style=color:#a6e22e>body</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>m</span>)

	<span style=color:#75715e>// send back response with &#34;Hello name!&#34; in the specified language
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Fprintf</span>(<span style=color:#a6e22e>w</span>, <span style=color:#e6db74>&#34;%s %s!&#34;</span>, <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>Message</span>, <span style=color:#a6e22e>name</span>)
}

<span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
	<span style=color:#75715e>// expose Prometheus metrics
</span><span style=color:#75715e></span>	<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>Handle</span>(<span style=color:#e6db74>&#34;/metrics&#34;</span>, <span style=color:#a6e22e>promhttp</span>.<span style=color:#a6e22e>Handler</span>())
	<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>HandleFunc</span>(<span style=color:#e6db74>&#34;/&#34;</span>, <span style=color:#a6e22e>HelloHandler</span>)

	<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ListenAndServe</span>(<span style=color:#e6db74>&#34;:8080&#34;</span>, <span style=color:#66d9ef>nil</span>)
}
</code></pre></div><p>This will expose the metrics to the endpoint <code>/metrics</code>. You can learn more about the Go client library from its <a href="https://github.com/prometheus/client_golang?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>GitHub repo</a>.</p><h3 id=instrumenting-and-exporting-metrics-from-the-python-service>Instrumenting and Exporting Metrics from the Python Service<a hidden class=anchor aria-hidden=true href=#instrumenting-and-exporting-metrics-from-the-python-service>#</a></h3><p>Prometheus also has an <a href="https://github.com/prometheus/client_python?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>official Python client library</a>. There are also third-party libraries that are tailored to fit specific use cases.</p><p>Our service uses <a href="https://fastapi.tiangolo.com/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>FastAPI</a>, and we will use the <a href="https://github.com/trallnag/prometheus-fastapi-instrumentator#creating-new-metrics?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>prometheus_fastapi_instrumentator</a> library to instrument it:</p><div class=highlight title=main.py><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>from</span> fastapi <span style=color:#f92672>import</span> FastAPI
<span style=color:#f92672>from</span> fastapi.middleware.cors <span style=color:#f92672>import</span> CORSMiddleware

<span style=color:#f92672>from</span> prometheus_fastapi_instrumentator <span style=color:#f92672>import</span> Instrumentator

app <span style=color:#f92672>=</span> FastAPI()

hello <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;en&#34;</span>: <span style=color:#e6db74>&#34;Hello&#34;</span>, <span style=color:#e6db74>&#34;fr&#34;</span>: <span style=color:#e6db74>&#34;Bonjour&#34;</span>, <span style=color:#e6db74>&#34;es&#34;</span>: <span style=color:#e6db74>&#34;Hola&#34;</span>, <span style=color:#e6db74>&#34;ml&#34;</span>: <span style=color:#e6db74>&#34;ഹലോ&#34;</span>}

<span style=color:#75715e># expose the default Python metrics to the /metrics endpoint</span>
Instrumentator()<span style=color:#f92672>.</span>instrument(app)<span style=color:#f92672>.</span>expose(app)

<span style=color:#a6e22e>@app</span><span style=color:#f92672>.</span>get(<span style=color:#e6db74>&#34;/</span><span style=color:#e6db74>{lang}</span><span style=color:#e6db74>&#34;</span>)
<span style=color:#66d9ef>async</span> <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_hello</span>(lang):
    <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#34;message&#34;</span>: hello[lang]}
</code></pre></div><p>You can learn more about creating custom metrics from the <a href="https://github.com/trallnag/prometheus-fastapi-instrumentator#creating-new-metrics?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>documentation</a>.</p><h3 id=configuring-prometheus>Configuring Prometheus<a hidden class=anchor aria-hidden=true href=#configuring-prometheus>#</a></h3><p>We can now scrape and collect these metrics in Prometheus.</p><p>You can configure Prometheus to collect metrics from each of the services. By default, Prometheus checks for metrics in the <code>/metrics</code> path:</p><div class=highlight title=prometheus.yml><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>global</span>:
  <span style=color:#f92672>scrape_interval</span>: <span style=color:#ae81ff>15s</span>
  <span style=color:#f92672>evaluation_interval</span>: <span style=color:#ae81ff>15s</span>

<span style=color:#f92672>scrape_configs</span>:
  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#34;prometheus&#34;</span>
    <span style=color:#f92672>static_configs</span>:
      - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#34;localhost:9090&#34;</span>]
  
  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#34;go-app&#34;</span>
    <span style=color:#f92672>static_configs</span>:
      - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#34;go-app:8080&#34;</span>]

  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#34;python-app&#34;</span>
    <span style=color:#f92672>static_configs</span>:
      - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#34;python-app:8000&#34;</span>]

  - <span style=color:#f92672>job_name</span>: <span style=color:#e6db74>&#34;apisix&#34;</span>
    <span style=color:#f92672>static_configs</span>:
      - <span style=color:#f92672>targets</span>: [<span style=color:#e6db74>&#34;apisix:9080&#34;</span>]
    <span style=color:#f92672>metrics_path</span>: <span style=color:#e6db74>&#34;/prometheus/metrics&#34;</span>
</code></pre></div><p>That&rsquo;s it! Now, if you open up the Prometheus dashboard (default on port <code>9090</code>) and click on &ldquo;Status&rdquo; from the navbar and &ldquo;Targets,&rdquo; you will be able to see the status of metrics being scraped from your services.</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/prometheus-target-status.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/prometheus-target-status.png#center alt="Prometheus targets"></a><figcaption>Prometheus targets<p>Metrics are successfully being scraped from all sources</p></figcaption></figure><h2 id=querying-and-visualizing-metrics-in-prometheus>Querying and Visualizing Metrics in Prometheus<a hidden class=anchor aria-hidden=true href=#querying-and-visualizing-metrics-in-prometheus>#</a></h2><p>Now, you can use the Prometheus dashboard to run queries and complex expressions.</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/prometheus-query.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/prometheus-query.png#center alt="Querying Prometheus"></a><figcaption>Querying Prometheus<p>You can get a lot more complex with your queries than this</p></figcaption></figure><p>You can learn more about querying Prometheus in the <a href="https://prometheus.io/docs/prometheus/latest/querying/basics/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>official documentation</a>.</p><h2 id=using-grafana-to-query-prometheus>Using Grafana to Query Prometheus<a hidden class=anchor aria-hidden=true href=#using-grafana-to-query-prometheus>#</a></h2><p>Grafana is an open source data visualization platform that works with Prometheus to provide a comprehensive tool for collecting, querying, and visualizing metrics.</p><p>Prometheus is good at collecting metrics and querying but lacks in providing tooling for creating meaningful visualizations. Grafana overcomes this limitation by transforming the collected metrics into visualizations.</p><p>Grafana is also compatible with <a href="https://grafana.com/grafana/plugins/?type=datasource?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>many other data sources</a> than Prometheus.</p><p>Once you have deployed Grafana, you can open the web UI (default on port <code>3000</code>).</p><p>First, you have to add Prometheus as a data source. To do this, go to `/datasources or &ldquo;Configuration&rdquo; and &ldquo;Data sources.&rdquo; Click on &ldquo;Add data source&rdquo; and select Prometheus. Specify where Prometheus is deployed, save and test the connection.</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/grafana-add-prometheus.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/grafana-add-prometheus.png#center alt="Add Prometheus as a data source"></a><figcaption>Add Prometheus as a data source<p>Add the details of your Prometheus service, save, and test it</p></figcaption></figure><h3 id=using-pre-built-grafana-dashboards>Using Pre-built Grafana Dashboards<a hidden class=anchor aria-hidden=true href=#using-pre-built-grafana-dashboards>#</a></h3><p>Grafana hosts a <a href="https://grafana.com/grafana/dashboards/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>public dashboard repository</a> that contains pre-built Grafana dashboards. You can use them in your Grafana instance to quickly visualize relevant metrics.</p><p>We will use the <a href="https://grafana.com/grafana/dashboards/6671-go-processes/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Go Processes</a> dashboard which will process and visualize the process status published by the Prometheus Go client library.</p><p>To import this template, first, copy its ID (<code>6671</code>) from the dashboard repository. In your Grafana UI, go to &ldquo;Dashboards&rdquo; and select &ldquo;Import.&rdquo; Paste the ID you copied and click &ldquo;Load.&rdquo;</p><figure class=align-center><a href=/images/introduction-to-monitoring-microservices/grafana-dashboard.png target=_blank><img loading=lazy src=/images/introduction-to-monitoring-microservices/grafana-dashboard.png#center alt="Grafana dashboard"></a><figcaption>Grafana dashboard<p>Visualizes the process status of the Go service</p></figcaption></figure><p>You can also explore other pre-built dashboards or create your own. Refer to the <a href="https://grafana.com/blog/2022/06/06/grafana-dashboards-a-complete-guide-to-all-the-different-types-you-can-build/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>documentation</a> to learn more about this.</p><h2 id=whats-next>What&rsquo;s Next?<a hidden class=anchor aria-hidden=true href=#whats-next>#</a></h2><p>That&rsquo;s it for this tutorial!</p><p>This article was only an introduction to how you can set up monitoring on your services, and I encourage you to learn more about Prometheus and Grafana from the resources mentioned below:</p><ul><li><a href="https://prometheus.io/docs/practices/naming/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Prometheus Best Practices</a></li><li><a href="https://prometheus.io/docs/tutorials/alerting_based_on_metrics/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Alerting based on metrics</a></li><li><a href="https://grafana.com/docs/grafana/latest/dashboards/?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>Grafana Dashboards</a></li></ul><p>The complete code and the Docker Compose file for this tutorial are available in <a href="https://github.com/pottekkat/monitoring-101?utm_source=navendu_blog&utm_medium=referral&utm_campaign=an-introduction-to-monitoring-microservices-with-prometheus-and-grafana" target=_blank>monitoring-101</a>.</p><section class=subscribe-content><hr><p>Thank you for reading <i>"An Introduction to Monitoring Microservices with Prometheus and Grafana."</i></p><p>Subscribe via <a href=/subscribe>email</a> or
<a href=/index.xml target=_blank>RSS feed</a> to be the first to receive
my content.</p><p>If you liked this post, check out my <a href=/categories/featured>featured posts</a> or learn more <a href=/about>about me</a>.</p></section><section class=subscription-form><form action="https://navendu.us5.list-manage.com/subscribe/post-json?u=fb9ffeb3ee6bc8aaf1d5b8a98&id=5ff8367bc1&c=?" method=post autocomplete=off class=subscribe-form><div class=subscribe-input><input type=email name=EMAIL id=email required placeholder="Email Address ↵" title="Email Address"></div><input value=Subscribe type=submit class=subscribe-button title=Subscribe></form><section class=entry-content><div class=subscribe-message>Get a biweekly dose of tech news, curated content, and uninterrupted musings.</div></section></section><script>$(".subscribe-form").submit(function(d){var a,b,c;d.preventDefault(),a=$(this),b=a.attr("action"),c=a.attr("method"),$.ajax({type:c,url:b,data:a.serialize(),dataType:`jsonp`,success:function(b){b.result===`success`?(a.find(".subscribe-button").attr("value","Subscribed!"),$(".subscribe-message").html("Thank you for subscribing! Check your inbox and add me in your contacts to not miss an issue! <a target='_blank' href='https://twitter.com/intent/tweet?url=https%3A%2F%2Fnavendu.me&text=I%20just%20subscribed%20to%20@sudo_navendu%27s%20blog%21%20Check%20it%20out%21&hashtags=OpenSource%2CDevelopers%2CDEVCommunity'>Tweet about it</a>!"),$(".subscribe-form :input").prop("disabled",!0)):(a.find(".subscribe-button").attr("value","Failed to Subscribe! Click again to retry"),$(".subscribe-message").html("There was an error subscribing you to my blog. "+b.msg+"."),a[0].reset()),console.log(b)},error:function(b){console.log("An error occurred."),console.log(b),a[0].reset()}})})</script></div><footer class=post-footer><ul class=post-tags><li><a href=https://navendu.me/tags/monitoring/>monitoring</a></li><li><a href=https://navendu.me/tags/prometheus/>prometheus</a></li><li><a href=https://navendu.me/tags/tutorials/>tutorials</a></li></ul><nav class=paginav><a class=prev href=https://navendu.me/posts/how-i-ask-questions/><span class=title>« Prev</span><br><span>How I Ask Questions as a Software Engineer</span></a>
<a class=next href=https://navendu.me/posts/best-practices-for-building-reliable-apis/><span class=title>Next »</span><br><span>Best Practices for Building Reliable APIs</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on twitter" href="https://twitter.com/intent/tweet/?text=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f&hashtags=monitoring%2cprometheus%2ctutorials"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f&title=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&summary=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&source=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f&title=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on whatsapp" href="https://api.whatsapp.com/send?text=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana%20-%20https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share An Introduction to Monitoring Microservices with Prometheus and Grafana on telegram" href="https://telegram.me/share/url?text=An%20Introduction%20to%20Monitoring%20Microservices%20with%20Prometheus%20and%20Grafana&url=https%3a%2f%2fnavendu.me%2fposts%2fintroduction-to-monitoring-microservices%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>This work by <a href=https://navendu.me/about/#about-me>Navendu Pottekkat</a></span>
<span>is licensed under <a rel=license href=http://creativecommons.org/licenses/by-sa/4.0 target=_blank>CC BY-SA 4.0</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerHTML='copy';function d(){a.innerHTML='copied!',setTimeout(()=>{a.innerHTML='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script><script>for(var els=document.getElementsByClassName("highlight"),i=0,title,code,newNode;i<els.length;i++)title=els[i].title,code=els[i].firstElementChild.firstElementChild,title.length&&(newNode=document.createElement("div"),newNode.textContent=title,newNode.classList.add("highlight-title"),code.parentNode.insertBefore(newNode,code))</script></body></html>